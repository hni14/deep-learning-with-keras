# MNISTデータ・セットで畳み込みニューラルネットワークの訓練を行う例

## 概要
手書きされた数字を表すグレースケール画像(28ピクセル×28ピクセル)を10個のカテゴリ(0〜9)に分類するモデルの作成に取り組みます。  
この例題を通じて、以下の理解を目指します。

- ディープラーニングの基本的なワークフロー
  - 
- 畳み込みニューラルネットワーク
  - 

## データの準備

### MNISTから画像データをロードする。
今回取り組む問題は教師あり学習です。  
そのため、ニューラルネットワークの学習のために、訓練用のデータと正解ラベルを入力する必要があります。  
Kerasライブラリでは、組み込みでサンプルデータ・セットが用意されています。  
このMNISTというデータ・セットは、手書き数字の画像セットです。  
簡単な実験から論文で用いられる等よく利用されるデータ・セットです。 　
次のように読み込むことができます。  

```python
from keras.datasets import mnist
 
# データ・セットを訓練データ、テストデータに分けて読み込みできる。
(x_train, y_train), (x_test, y_test) = mnist.load_data()
```

train_imagesは訓練用の画像データであり、train_labelsは訓練用の画像に対するラベル(1が描かれてる画像に対して、1というラベルがつけれている)。
test_imagesはテスト用の画像データで、test_labelsはテスト用画像データに対するラベルです。  

訓練用とテスト用に分けて読み込む理由は、後にモデルの汎化性能(学習に用いられていない未知のデータに対する分類性能)を確認するためです。  

読み込んだデータ・セットの形状を確認します。  
訓練データ・セットには６万のサンプル画像があり、それぞれ28ピクセル×28ピクセルです。  
3次元のテンソル(多次元配列)の形をとっており、はじめの次元はサンプルを表します。  

```python
print(x_train.shape)
# (60000, 28, 28)
```

これを確認するために、訓練データ・セットの1番目の画像をmatplotlibで可視化してみます。  

```python
from matplotlib import pyplot as plt
plt.imshow(x_train[0])
```

ラベルは、0〜9の数字の配列で、画像とラベルは1対1で対応しています。  
```python
print(y_train.shape)
# (60000,)
print(y_train)
# [5 0 4 ... 5 6 8]
```

これを確認するために、先ほど可視化した画像のラベルを確認します。  
```python
print(y_train[0])
# 5
```

### 入力データの前処理
各ピクセルは0〜255のグレースケール値をとりますが、これを0〜1の範囲に収まるように変換処理をします。  
具体的には、float32型でキャストして255で割ることで、0〜1の範囲の浮動小数点に変換します。  
この変換処理を正規化(normalization)と呼びます。  
ニューラルネットワークの学習では、一般的に0〜1の範囲の値になるようにし、複数の種類の異なるデータ

```python
x_train = x_train.astype('float32')
x_test = x_test.astype('float32')
x_train /= 255
x_test /= 255
```

### クラスラベルの前処理


訓練データセット、検証データ・セット、テストデータ・セット
モデルの評価は、利用可能なデータ・セットを訓練データ・セット、検証データセット、テストデータセットの３つに分割します。
モデルの訓練は訓練データ・セットで行い、モデルの評価は検証データで行います。
モデルの準備が整ったら、最後にテストデータでテストします。
訓練データ・セットとテストデータ・セットの２つで十分と思えますが、モデルの開発で常に設定のチューニングが必要になり、たとえば、層の数や層のサイズなどの選択が必要になります。
これらの設定はネットワークの重みであるパラメータと区別するために、モデルのハイパーパラメータと呼ばれます。
チューニングでは、モデルの検証データでの性能をフィードバックとして使用します。このチューニングは一種の学習です。つまり、


## ニューラルネットワークの訓練

### ミニバッチ学習

### エポック

